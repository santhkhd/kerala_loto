<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kerala Lotery Home</title>
  <link href="output.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #e9edf5;
      margin: 0;
      color: #222;
    }
    .lottery-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 22px;
      justify-content: center;
      padding: 24px 0 36px 0;
      max-width: 900px;
      margin: 0 auto;
      box-sizing: border-box;
    }
    .lottery-card {
      background: #232946;
      color: #fff;
      border-radius: 16px;
      min-width: 0;
      width: 100%;
      min-height: 110px;
      box-shadow: 0 4px 18px rgba(30,60,120,0.13);
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: flex-start;
      padding: 0;
      text-decoration: none;
      transition: box-shadow 0.18s, transform 0.18s, background 0.18s;
      overflow: hidden;
      cursor: pointer;
      border: none;
      margin: 0;
    }
    .lottery-card:hover, .lottery-card:active {
      box-shadow: 0 10px 32px rgba(37,99,235,0.22);
      transform: translateY(-2px) scale(1.025);
    }
    .card-top {
      width: 100%;
      background: #232946;
      padding: 22px 16px 10px 16px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
      min-height: 70px;
      box-sizing: border-box;
      position: relative;
    }
    .card-bottom {
      width: 100%;
      background: #fff;
      color: #232946;
      font-size: 1.13em;
      font-weight: 700;
      border-bottom-left-radius: 16px;
      border-bottom-right-radius: 16px;
      padding: 13px 0 10px 0;
      text-align: center;
      letter-spacing: 1.2px;
      box-shadow: 0 2px 8px rgba(37,99,235,0.07);
    }
    .badge {
      position: absolute;
      top: 10px;
      right: 12px;
      background: #3b82f6;
      color: #fff;
      font-size: 0.82em;
      font-weight: 600;
      padding: 2px 10px;
      border-radius: 7px;
      box-shadow: 0 1px 4px rgba(37,99,235,0.10);
      letter-spacing: 0.5px;
      z-index: 2;
    }
    .new-ribbon {
      position: absolute;
      top: 0;
      left: 0;
      background: #ef233c;
      color: #fff;
      font-size: 0.92em;
      font-weight: bold;
      padding: 3px 18px 3px 10px;
      border-radius: 0 0 14px 0;
      z-index: 2;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(239,35,60,0.10);
    }
    .lottery-title {
      font-size: 1.13em;
      font-weight: 700;
      margin-bottom: 6px;
      margin-top: 18px;
      letter-spacing: 1.1px;
      width: 100%;
      text-align: center;
      text-shadow: 0 2px 8px rgba(30,60,120,0.10);
      word-break: break-word;
      white-space: normal;
      line-height: 1.25;
      min-height: 2.5em;
      display: block;
    }
    @media (max-width: 900px) {
      .lottery-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    @media (max-width: 600px) {
      .lottery-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        padding: 8px 2px 12px 2px;
        max-width: 100vw;
        margin: 0;
      }
      .lottery-card {
        width: 100%;
        min-width: 0;
        max-width: 100vw;
        min-height: 100px;
        border-radius: 14px;
        margin: 0 auto;
      }
      .badge {
        font-size: 0.75em;
        padding: 2px 8px;
        border-radius: 6px;
        top: 8px;
        right: 10px;
      }
      .new-ribbon {
        font-size: 0.85em;
        padding: 2px 10px 2px 7px;
        border-radius: 0 0 8px 0;
      }
      .lottery-title {
        font-size: 0.97em;
        margin-top: 16px;
        min-height: 2.2em;
      }
    }
    body { padding-bottom: 60px !important; }
    .tab-btn {
      padding: 0.5rem 1.2rem;
      border-radius: 9999px;
      font-weight: 600;
      color: #374151;
      background: #f3f4f6;
      border: none;
      outline: none;
      cursor: pointer;
      white-space: nowrap;
      margin-right: 0.5rem;
      transition: background 0.2s, color 0.2s;
    }
    .tab-btn.active {
      background: #2563eb;
      color: #fff;
      box-shadow: 0 2px 8px rgba(37,99,235,0.10);
    }
    /* Make tab bar scrollable and mobile-friendly */
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    #lotteryTabs {
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      min-width: 100vw;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <!-- Header with language switcher -->
  <div class="w-full bg-gradient-to-r from-blue-900 to-blue-500 text-white py-5 px-4 flex items-center justify-between shadow-md relative">
    <span id="header-title" class="text-lg font-bold flex-1 text-center">Kerala Lottery Results</span>
    <div class="flex items-center gap-3">
      <a href="live.html" class="inline-flex items-center bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 animate-pulse" title="Watch Live Draw">
        <span class="text-sm font-bold">LIVE </span>
      </a>
      <button class="text-2xl bg-transparent border-none text-white hover:bg-blue-800/30 rounded-full p-2 transition" id="langIconBtn" title="Change language">üåê</button>
    </div>
    <div class="hidden fixed top-16 right-4 z-50 bg-white rounded-xl shadow-lg p-6 min-w-[180px]" id="langPopup">
      <div class="font-bold text-blue-700 mb-2">Select Language</div>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="en">English</button>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
    </div>
  </div>

  <!-- Scrolling Tab Bar for Lottery Categories -->
  <div class="w-full overflow-x-auto bg-white shadow-sm border-b border-gray-200 scrollbar-hide">
    <div class="flex space-x-4 px-4 py-2 min-w-max scrollbar-hide" id="lotteryTabs" tabindex="0" role="tablist">
      <button class="tab-btn active" data-category="ALL">All</button>
      <button class="tab-btn" data-category="KARUNYA">Karunya</button>
      <button class="tab-btn" data-category="KARUNYA_PLUS">Karunya Plus</button>
      <button class="tab-btn" data-category="SUVARNA_KERALAM">Suvarna Keralam</button>
      <button class="tab-btn" data-category="STHREE_SAKTHI">Sthree Sakthi</button>
      <button class="tab-btn" data-category="DHANALEKSHMI">Dhanalekshmi</button>
      <button class="tab-btn" data-category="SAMRUDHI">Samrudhi</button>
      <button class="tab-btn" data-category="BHAGYATHARA">Bhagyathara</button>
    </div>
  </div>

  <div class="w-full px-1 sm:px-4">
    <div class="max-w-4xl mx-auto w-full">
    <!-- Lottery Grid -->
    <div class="lottery-grid" id="lottery-grid">
      <!-- Lottery cards will be generated here by JavaScript -->
    </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="fixed bottom-0 left-0 w-full bg-gray-900 flex justify-around items-center py-2 shadow-lg z-40">
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="index.html">
      <span class="material-icons">home</span>
      <span class="text-xs">Home</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="prediction.html">
      <span class="material-icons">star</span>
      <span class="text-xs">Lucky</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="search.html">
      <span class="material-icons">search</span>
      <span class="text-xs">Search</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="scanner.html">
      <span class="material-icons">qr_code_scanner</span>
      <span class="text-xs">Scanner</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="live.html">
      <span class="material-icons">live_tv</span>
      <span class="text-xs">Live</span>
    </a>
  </nav>

  <script>
    // Language logic
    let currentLang = localStorage.getItem('lang') || 'en';

    const langStrings = {
      en: 'Kerala Lottery Results',
      ml: '‡¥ï‡µá‡¥∞‡¥≥ ‡¥≤‡µã‡¥ü‡µç‡¥ü‡¥±‡¥ø ‡¥´‡¥≤‡¥Ç',
      ta: '‡Æï‡Øá‡Æ∞‡Æ≥‡Ææ ‡Æ≤‡Ææ‡Æü‡Øç‡Æü‡Æ∞‡Æø ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç'
    };

    // Short language strings for mobile
    const langStringsShort = {
      en: 'Kerala Lottery',
      ml: '‡¥ï‡µá‡¥∞‡¥≥ ‡¥≤‡µã‡¥ü‡µç‡¥ü‡¥±‡¥ø',
      ta: '‡Æï‡Øá‡Æ∞‡Æ≥‡Ææ ‡Æ≤‡Ææ‡Æü‡Øç‡Æü‡Æ∞‡Æø'
    };

    // Lottery name translations
    const lotteryNameTranslations = {
      SAMRUDHI: { en: 'SAMRUDHI', ml: '‡¥∏‡¥Æ‡µÉ‡¥¶‡µç‡¥ß‡¥ø', ta: '‡Æö‡ÆÆ‡Øç‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø' },
      BHAGYATHARA: { en: 'BHAGYATHARA', ml: '‡¥≠‡¥æ‡¥ó‡µç‡¥Ø‡¥§‡¥æ‡¥∞', ta: '‡Æ™‡Ææ‡Æï‡Øç‡ÆØ‡Æ§‡Ææ‡Æ∞‡Ææ' },
      STHREE_SAKTHI: { en: 'STHREE-SAKTHI', ml: '‡¥∏‡µç‡¥§‡µç‡¥∞‡µÄ-‡¥∂‡¥ï‡µç‡¥§‡¥ø', ta: '‡Æ∏‡Øç‡Æ§‡Øç‡Æ∞‡ØÄ-‡Æö‡Æï‡Øç‡Æ§‡Æø' },
      DHANALEKSHMI: { en: 'DHANALEKSHMI', ml: '‡¥ß‡¥®‡¥≤‡¥ï‡µç‡¥∑‡µç‡¥Æ‡¥ø', ta: '‡Æ§‡Æ©‡Æ≤‡Æü‡Øç‡Æö‡ØÅ‡ÆÆ‡Æø' },
      KARUNYA_PLUS: { en: 'KARUNYA PLUS', ml: '‡¥ï‡¥∞‡µÅ‡¥£‡µç‡¥Ø ‡¥™‡µç‡¥≤‡¥∏‡µç', ta: '‡Æï‡Æ∞‡ØÅ‡Æ£‡Øç‡ÆØ‡Ææ ‡Æ™‡Æø‡Æ≥‡Æ∏‡Øç' },
      SUVARNA_KERALAM: { en: 'SUVARNA KERALAM', ml: '‡¥∏‡µÅ‡¥µ‡µº‡¥£ ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç', ta: '‡Æö‡ØÅ‡Æµ‡Æ∞‡Øç‡Æ£ ‡Æï‡Øá‡Æ∞‡Æ≥‡ÆÆ‡Øç' },
      KARUNYA: { en: 'KARUNYA', ml: '‡¥ï‡¥∞‡µÅ‡¥£‡µç‡¥Ø', ta: '‡Æï‡Æ∞‡ØÅ‡Æ£‡Øç‡ÆØ‡Ææ' },
      'MONSOON BUMPER': { en: 'MONSOON BUMPER', ml: '‡¥Æ‡µ∫‡¥∏‡µÇ‡µ∫ ‡¥¨‡¥Æ‡µç‡¥™‡µº', ta: '‡ÆÆ‡Ææ‡Æ©‡Øç‡Æö‡ØÇ‡Æ©‡Øç ‡Æ™‡ÆÆ‡Øç‡Æ™‡Æ∞‡Øç' } // Added Monsoon Bumper
    };

    function setLang(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      updateHeaderTitle();
      document.title = langStrings[lang] || langStrings['en'];
      renderLotteryCards(lang);
    }

    function updateHeaderTitle() {
      const w = window.innerWidth;
      if (w < 400) {
        document.getElementById('header-title').textContent = langStringsShort[currentLang] || langStringsShort['en'];
      } else {
        document.getElementById('header-title').textContent = langStrings[currentLang] || langStrings['en'];
      }
    }

    window.addEventListener('resize', updateHeaderTitle);

    // Language popup setup
    document.addEventListener('DOMContentLoaded', function() {
      const langIconBtn = document.getElementById('langIconBtn');
      const langPopup = document.getElementById('langPopup');
      const langPopupBtns = langPopup.querySelectorAll('.lang-popup-btn');

      langIconBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        langPopup.classList.toggle('hidden');
      });

      document.body.addEventListener('click', function(e) {
        if (!langPopup.contains(e.target) && e.target !== langIconBtn) {
          langPopup.classList.add('hidden');
        }
      });

      langPopupBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          setLang(this.getAttribute('data-lang'));
          langPopup.classList.add('hidden');
        });
      });

      setLang(currentLang);
    });

    let allCards = [];

    function renderLotteryCards(lang, filterCategory = 'ALL') {
      allCards = [];
      const schedule = [
        { dayOfWeek: 0, name: 'SAMRUDHI', shortName: 'SM', baseNumber: 9, baseDate: '2025-06-29' },
        { dayOfWeek: 1, name: 'BHAGYATHARA', shortName: 'BT', baseNumber: 8, baseDate: '2025-06-23' },
        { dayOfWeek: 2, name: 'STHREE_SAKTHI', shortName: 'SS', baseNumber: 473, baseDate: '2025-06-24' },
        { dayOfWeek: 3, name: 'DHANALEKSHMI', shortName: 'DL', baseNumber: 7, baseDate: '2025-06-25' },
        { dayOfWeek: 4, name: 'KARUNYA_PLUS', shortName: 'KN', baseNumber: 578, baseDate: '2025-06-26' },
        { dayOfWeek: 5, name: 'SUVARNA_KERALAM', shortName: 'SK', baseNumber: 9, baseDate: '2025-06-27' },
        { dayOfWeek: 6, name: 'KARUNYA', shortName: 'KR', baseNumber: 712, baseDate: '2025-06-28' }
      ];
      const now = new Date();
      const istTime = new Date(now.getTime() + (330 * 60 * 1000));
      const today = new Date(Date.UTC(istTime.getUTCFullYear(), istTime.getUTCMonth(), istTime.getUTCDate()));
      const todayStr = today.toISOString().split('T')[0];

      const specialResults = {
          '2025-07-23': { name: 'MONSOON BUMPER', shortName: 'BR', drawNumber: '104' }
      };

      for (let i = 0; i < 90; i++) {
        const date = new Date(today);
        date.setDate(date.getDate() - i);
        const yyyy = date.getFullYear();
        const mm = String(date.getMonth() + 1).padStart(2, '0');
        const dd = String(date.getDate()).padStart(2, '0');
        const dataDateStr = `${yyyy}-${mm}-${dd}`;
        const cardDateStr = `${dd}/${mm}/${yyyy}`;
        const isNew = (dataDateStr === todayStr);

        let lotteryName, lotteryShortName, drawNumber, link;

        if (specialResults[dataDateStr]) {
            // Handle special result (e.g., Monsoon Bumper)
            const special = specialResults[dataDateStr];
            lotteryName = special.name;
            lotteryShortName = special.shortName;
            drawNumber = special.drawNumber;
            link = `result.html?file=${lotteryShortName}-${drawNumber}-${dataDateStr}.json`;
        } else {
            // Handle regular scheduled lotteries
            const dayOfWeek = date.getDay();
            const lottery = schedule.find(l => l.dayOfWeek === dayOfWeek);
            if (!lottery) continue; // Skip if no lottery scheduled for this day

            lotteryName = lottery.name;
            lotteryShortName = lottery.shortName;
            const baseDate = new Date(lottery.baseDate);
            const daysDifference = (date - baseDate) / (1000 * 60 * 60 * 24);
            const weeksPassed = Math.floor(daysDifference / 7);
            drawNumber = String(lottery.baseNumber + weeksPassed);
            link = `result.html?file=${lotteryShortName}-${drawNumber}-${dataDateStr}.json`;
        }

        // Apply category filter
        if (filterCategory === 'ALL' || lotteryName === filterCategory || (specialResults[dataDateStr] && specialResults[dataDateStr].name === filterCategory)) {
             const translatedName = lotteryNameTranslations[lotteryName][lang] || lotteryNameTranslations[lotteryName]['en'];

            allCards.push(`
              <a class="lottery-card" href="${link}">
                  <div class="card-top">
                      ${isNew ? `<span class="new-ribbon">NEW</span>` : ''}
                      <span class="badge">${lotteryShortName}-${drawNumber}</span>
                      <div class="lottery-title">${translatedName}</div>
                  </div>
                  <div class="card-bottom">${cardDateStr}</div>
              </a>
            `);
        }
      }
      // Show all cards at once, no pagination
      const grid = document.getElementById('lottery-grid');
      if (grid) grid.innerHTML = allCards.join('');
    }

    document.addEventListener('DOMContentLoaded', function() {
      setLang(currentLang);
      updateHeaderTitle();
    });

    // Tab bar filtering logic
    document.addEventListener('DOMContentLoaded', function() {
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          tabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          const category = this.getAttribute('data-category');
          renderLotteryCards(currentLang, category);
        });
      });
    });
  </script>
</body>
</html>
